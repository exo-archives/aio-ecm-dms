<?xml version="1.0" encoding="ISO-8859-1"?>
<configuration>		
	<component>
	   <key>org.exoplatform.services.cms.queries.QueryService</key>  
	   <type>org.exoplatform.services.cms.queries.impl.QueryServiceImpl</type>
	   <init-params>
		    <value-param>
		      <name>workspace</name>
		      <value>system</value>
		    </value-param>   
		    <value-param>
		      <name>relativePath</name>
		      <value>Private/Searches</value>
		    </value-param>
		    <value-param>
		      <name>group</name>
		      <value>*:/platform/administrators</value>
		    </value-param>            
	  	</init-params>	         
	</component>	
	
	<external-component-plugins>
		<target-component>org.exoplatform.services.cms.queries.QueryService</target-component>        		        
    <component-plugin> 
      <name>query.plugin</name>
      <set-method>setQueryPlugin</set-method>
      <type>org.exoplatform.services.cms.queries.impl.QueryPlugin</type>
      <description>Nothing</description>
      <init-params>
      	<value-param>
       	<name>autoCreateInNewRepository</name>
       	<value>true</value>
       </value-param>	        
       <value-param>
       	<name>repository</name>
       	<value>repository</value>
       </value-param>	        		        		    		    
       <object-param>        
         <name>CreatedDocuments</name>
         <description>documents created by the current user</description>
         <object type="org.exoplatform.services.cms.queries.impl.QueryData">              
           <field  name="name"><string>Created Documents</string></field>
           <field  name="language"><string>xpath</string></field>
           <field  name="statement"><string>//*[(@jcr:primaryType = 'exo:article' or @jcr:primaryType = 'nt:file') and @exo:owner='${UserId}$'] order by @exo:dateCreated descending</string></field>
           <field  name="permissions"><string>*:/platform/users</string></field>
		   <!-- Don't cache this query as it is sensitive to user -->
           <field  name="cachedResult"><boolean>false</boolean></field>             
         </object>
       </object-param>
       <object-param>        
         <name>CreatedDocumentsDayBefore</name>
         <description>documents created the day before</description>
         <object type="org.exoplatform.services.cms.queries.impl.QueryData">              
           <field  name="name"><string>CreatedDocumentDayBefore</string></field>
           <field  name="language"><string>xpath</string></field>
           <field  name="statement"><string>//element(*,exo:article)[@exo:dateCreated &lt; xs:dateTime('${Date}$')] order by @exo:dateCreated descending</string></field>
           <field  name="permissions"><string>*:/platform/users</string></field>
           <field  name="cachedResult"><boolean>true</boolean></field>             
         </object>
       </object-param>
       <object-param>        
         <name>ValidatingDocuments</name>
         <description>documents are in validation request state</description>
         <object type="org.exoplatform.services.cms.queries.impl.QueryData">              
           <field  name="name"><string>Validating Documents</string></field>
           <field  name="language"><string>xpath</string></field>
           <field  name="statement"><string>//element(*,exo:publishingState)[@exo:currentState='Request For Validation'] order by @exo:dateCreated descending</string></field>           
           <field  name="permissions"><string>*:/platform/users</string></field>
           <field  name="cachedResult"><boolean>true</boolean></field>             
         </object>
       </object-param>
       <object-param>        
         <name>PendingDocuments</name>
         <description>documents are in waiting for publishing state</description>
         <object type="org.exoplatform.services.cms.queries.impl.QueryData">              
           <field  name="name"><string>Pending Documents</string></field>
           <field  name="language"><string>xpath</string></field>           
           <field  name="statement"><string>//element(*,exo:publishingState)[@exo:currentState='Pending'] order by @exo:dateCreated descending</string></field>
           <field  name="permissions"><string>*:/platform/users</string></field>
           <field  name="cachedResult"><boolean>true</boolean></field>             
         </object>
       </object-param>
       <object-param>        
         <name>PublishingDocuments</name>
         <description>documents are in publishing state</description>
         <object type="org.exoplatform.services.cms.queries.impl.QueryData">              
           <field  name="name"><string>Publishing Documents</string></field>
           <field  name="language"><string>xpath</string></field>
           <field  name="statement"><string>//element(*,exo:publishingState)[@exo:currentState='Publishing'] order by @exo:dateCreated descending</string></field>
           <field  name="permissions"><string>*:/platform/users</string></field>
           <field  name="cachedResult"><boolean>true</boolean></field>             
         </object>
       </object-param>
       <object-param>        
         <name>BackupDocuments</name>
         <description>documents are in backup state</description>
         <object type="org.exoplatform.services.cms.queries.impl.QueryData">              
           <field  name="name"><string>Backup Documents</string></field>
           <field  name="language"><string>xpath</string></field>
           <field  name="statement"><string>//element(*,exo:publishingState)[@exo:currentState='Backup'] order by @exo:dateCreated descending</string></field>
           <field  name="permissions"><string>*:/platform/users</string></field>
           <field  name="cachedResult"><boolean>true</boolean></field>             
         </object>
       </object-param>
       <object-param>        
         <name>AllArticles</name>
         <description>All articles</description>
         <object type="org.exoplatform.services.cms.queries.impl.QueryData">              
           <field  name="name"><string>All Articles</string></field>
           <field  name="language"><string>xpath</string></field>
           <field  name="statement"><string>//element(*,exo:article) order by @exo:dateCreated descending</string></field>
           <field  name="permissions"><string>*:/platform/users</string></field>
           <field  name="cachedResult"><boolean>true</boolean></field>             
         </object>
       </object-param>
       <object-param>        
         <name>AllEvents</name>
         <description>All events</description>
         <object type="org.exoplatform.services.cms.queries.impl.QueryData">              
           <field  name="name"><string>All Events</string></field>
           <field  name="language"><string>xpath</string></field>
           <field  name="statement"><string>//element(*,exo:events) order by @exo:dateCreated descending</string></field>
           <field  name="permissions"><string>*:/platform/users</string></field>
           <field  name="cachedResult"><boolean>true</boolean></field>             
         </object>
       </object-param>       
   		</init-params>  
		</component-plugin>  		
 </external-component-plugins>	      
</configuration>
