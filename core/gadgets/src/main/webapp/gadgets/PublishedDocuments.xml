<?xml version="1.0" encoding="UTF-8" ?>
<!--
 **
 * Created by The eXo Platform SARL
 * Author : minh.dang@exoplatform.com
 * March 05, 2009          
 *
-->
<Module>
	<ModulePrefs author="eXoPlatform"
		title="Published documents"
		directory_title="Published documents"
		title_url="http://www.exoplatform.org"
		description="The last published documents"
		thumbnail="http://localhost:8080/eXoDMSGadgets/skin/DefaultSkin/gadgetIcons/PublishedDocument.png"
		height="227">
	</ModulePrefs>
	<Content type="html">
	<![CDATA[
		<style type="text/css">
			body{
				font: 11px Tahoma,Verdana,Arial,Helvetica,sans-serif;
				height:100%;
				margin:0 auto;
				padding:0;
				width:315px;
			}
			
			a {
				text-decoration: none;
			}
			
			.FloatLeft{
				float: left;
			}
			.FloatRight{
				float: right;
			}
			.ClearRight{
				clear:right;
			}
			.ClearLeft{
				clear: left;
			}
			
			.GadgetBgTitleLeft{
				background:transparent url("/eXoDMSGadgets/skin/images/ImageGadGets.gif") no-repeat left -70px;
				padding-left: 4px;
			}
			
			.GadgetBgTitleCenter{
				background:transparent url("/eXoDMSGadgets/skin/images/ImageGadGets.gif") repeat-x left -92px;
				height: 22px;
			}
			
			.GadgetBgTitleRight{
				background:transparent url("/eXoDMSGadgets/skin/images/ImageGadGets.gif") no-repeat right -70px;
				padding-right:3px;
			}
			
			.TxtTitleGadget {
				font-weight: bold;
				float: left;
				line-height: 22px;
				color: #5b5b5b;
				padding-left: 8px;
			}
			
			.GadgetBgTitleCenter .IconEditGadGet{
				background:transparent url("/eXoDMSGadgets/skin/images/ImageGadGets.gif") no-repeat center -180px;
				display: block;
				height: 13px;
				width: 13px;
				padding: 6px 2px 0px 2px;
			}
			
			.GadgetBgTitleCenter .IconMinimize{
				background:transparent url("/eXoDMSGadgets/skin/images/ImageGadGets.gif") no-repeat center -202px;
				display: block;
				height: 13px;
				width: 13px;
				padding: 6px 2px 0px 2px;
			}
			
			.GadgetBgTitleCenter .IconClose{
				background:transparent url("/eXoDMSGadgets/skin/images/ImageGadGets.gif") no-repeat center -224px;
				display: block;
				height: 13px;
				width: 13px;
				padding: 6px 2px 0px 2px;
			}
			
			/**************************** Content Gadgets *********************************/
			
			.ContentGadGet{
			}
			
			.ContentGadGet .BgLeftTitleContent{
				background:transparent url("/eXoDMSGadgets/skin/images/ImageGadGets.gif") no-repeat left top;	
				padding-left: 6px;
			}
			
			.ContentGadGet .BgCentertTitleContent{
				background:transparent url("/eXoDMSGadgets/skin/images/ImageGadGets.gif") repeat-x left -35px;	
				height: 35px;
				line-height: 35px;
			}
			
			.ContentGadGet .BgRightTitleContent{
				background: url("/eXoDMSGadgets/skin/images/ImageGadGets.gif") no-repeat right top;	
				padding-right: 8px;
			}
			.ContentGadGet .IconArrow{
				background: url("/eXoDMSGadgets/skin/images/ImageGadGets.gif") no-repeat right -246px;
				float: right;
				height: 35px;
				width: 16px;
			}
			.ContentGadGet .TextTitle{
				color: #fff;
				font-weight: bold;
			}
			
			.ContentGadGet .BgLeftFooterContent{
				background: url("/eXoDMSGadgets/skin/images/ImageGadGets.gif") no-repeat left -114px;	
				padding-left: 9px;
			}
			
			.ContentGadGet .BgCenterFooterContent{
				background: url("/eXoDMSGadgets/skin/images/ImageGadGets.gif") repeat-x center -130px;
				height: 8px;
			}
			
			.ContentGadGet .BgRightFooterContent{
				background: url("/gadgets/skin/images/ImageGadGets.gif") no-repeat right -122px;	
				padding-right: 8px;
			}
			
			.ContentGadGet .BgCenterContent{
				background: url("/gadgets/skin/images/BgBottomConten.gif") repeat-x left bottom;
			}
			.ContentGadGet .BgLeftContent{
				border-left: solid 1px #9c9c9c;
			}
			
			.ContentGadGet .BgRightContent{
				background: url("/gadgets/skin/images/GagetBorRight.gif") repeat-y right top;
				padding-right: 3px;
			}
			
			.ContentGadGet .BgRightContent .IconDriver {
				background: url("/gadgets/skin/images/ImageGadGets.gif") no-repeat left -281px;
			
			}
			
			.ContentGadGet .BgRightContent .IconPdf {
				background: url("/gadgets/skin/images/ImageGadGets.gif") no-repeat left -352px;
			}
			
			.ContentGadGet .BgRightContent .IconDoc {
				background: url("/gadgets/skin/images/ImageGadGets.gif") no-repeat left -396px;
			}
			
			.ContentGadGet .BgRightContent .IconJpg {
				background: url("/gadgets/skin/images/ImageGadGets.gif") no-repeat left -440px;
			}
			
			.ContentGadGet .BgRightContent .IconNote {
				background:transparent url("/gadgets/skin/images/ImageGadGets.gif") no-repeat left -308px;
			}
			
			.ContentGadGet .BgRightContent .BgTitle{
				background: #dfeefa;
				width: auto;
				line-height: 16px;
				font-weight: bold;
				color: #468bcc;
			}
			
			.ContentGadGet .BgRightContent .ItemIcon {
				line-height: 16px;
				margin: 0px 5px 0px 11px;
				padding: 5px 0 5px 22px;
				width: auto;
			}
			
			.ContentGadGet .BgRightContent .TextDateTime{
				color: #83add4;
				float: left;
				padding-left: 26px;
			}
			
			.ContentGadGet .BgRightContent  .DateTime{
				color: #83add4;
				font-weight: nomarl;
			}
			
			.ContentGadGet .BgRightContent a{
				color: #000;
				display: block;
			}
			
			.ContentGadGet .BgRightContent a:hover{
				color: orange;
			}
	  </style>
    <script type="text/javascript">
			function PublishedDocument() {}
			
			PublishedDocument.prototype.makeRequest = function(url, callback) {
				var params = {};
				params[gadgets.io.RequestParameters.METHOD] = gadgets.io.MethodType.GET;
				params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.JSON;
				var ts = new Date().getTime();
			  var sep = "?";
			  var refreshInterval = 60;
			  if (refreshInterval && refreshInterval > 0) {
			    ts = Math.floor(ts / (refreshInterval * 1000));
			  }
			  if (url.indexOf("?") > -1) {
			    sep = "&";
			  }
			  url = [ url, sep, "nocache=", ts ].join("");
				gadgets.io.makeRequest(url, callback, params);
			}
			
			PublishedDocument.prototype.init = function() {
				var siteUrl = 'http://localhost:8080/portal/rest/publication/presentation/repository/collaboration/state?showItems=5';
				publishedDocument.makeRequest(siteUrl,publishedDocument.displayValue)
			}
			
			PublishedDocument.prototype.displayValue = function(resp) {
				var data = resp.data.publishedListNode;
				var publishedDocList = _gel("PublishedDocumentList");
				for (var i = 0; i < data.length; i++) {
					var doc = data[i];
					var AppClass = document.createElement('div');
					var showHTML = "<a href='#'>";
					showHTML+=doc.name;
					showHTML+="</a>";
					showHTML+="<span class='DateTime'>";
					showHTML+=doc.datePublished;
					showHTML+="</span>";
					AppClass.innerHTML = showHTML;
					AppClass.className = 'ItemIcon';
					publishedDocList.appendChild(AppClass);
				}
				gadgets.window.adjustHeight();
			}
			var publishedDocument = new PublishedDocument();
			
	    gadgets.util.registerOnLoadHandler(publishedDocument.init);
		</script>

		<body>
				
			<div class="ContentGadGet">
				<div class="BgLeftTitleContent">
					<div class="BgRightTitleContent">
						<div class="BgCentertTitleContent">
							<div class="IconArrow"><span></span></div>
							<div class="TextTitle">Recently Published Documents</div>
							<div class="ClearRight"><span></span></div>
						</div>
					</div>
				</div>
				<div class="BgRightContent">
					<div class="BgLeftContent">
						<div class="BgCenterContent">
						<div class="BgTitle">
							<div class="ItemIcon IconDriver">
								Collaboration center
							</div>
						</div>
						<div id="PublishedDocumentList" class="PublishedDocumentList">
						</div>
					</div>
					</div>
				</div>
				<div class="BgLeftFooterContent">
					<div class="BgRightFooterContent">
						<div class="BgCenterFooterContent"><span></span></div>
					</div>
				</div>
			</div>
		</body>
	]]>
	</Content>
</Module>
